@{
    ViewData["Title"] = "Home Page";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<!-- ====================== -->
<!-- PHẦN TRÌNH CHIẾU (TÙY CHỌN) -->
<!-- ====================== -->


<!-- ====================== -->
<!-- NỘI DUNG CHÍNH -->
<!-- ====================== -->
<section class="content-section">
    <div class="content">

        <!-- 🟢 TAB 1: TỪ VỰNG -->
        <div id="vocab" class="tab active">
            <div class="card">
                <h2>Từ vựng hôm nay</h2>
                <p><b id="vocabWord">Apple</b> → Quả táo</p>

                <button class="action" onclick="playAudio(document.getElementById('vocabWord').textContent)">🔊 Nghe phát âm</button>
                <button class="action" onclick="saveWord(document.getElementById('vocabWord').textContent)">⭐ Lưu từ</button>

                <br><br>

                <input type="text" id="customWord" placeholder="Nhập từ mới...">
                <button class="action" onclick="playAudio(document.getElementById('customWord').value)">🔊 Nghe phát âm từ nhập</button>
                <button class="action" onclick="saveWord(document.getElementById('customWord').value)">⭐ Lưu từ nhập</button>
            </div>
        </div>

        <!-- TAB NGHE & NÓI -->
        <div id="listening" class="tab">
            <div class="card listening-card">
                <h2 class="title">🎧 Bài nghe & Nói</h2>

                <!-- Hiển thị từ cần phát âm -->
                <div class="word-section">
                    <h3>🔤 Hãy phát âm từ sau:</h3>
                    <div id="randomWord" class="word-box">@ViewBag.Word</div>
                    <input type="hidden" name="referenceText" value="@ViewBag.Word" />

                    <button class="action-btn" id="newWordBtn" data-url="/Speech/Index">🎲 Lấy từ mới</button>
                </div>

                <!-- Ghi âm -->
                <div class="record-section">
                    <button class="action-btn start" id="startRecordingBtn">🎤 Bắt đầu ghi âm</button>
                    <button class="action-btn stop" id="stopRecordingBtn" disabled>⏹️ Dừng ghi âm</button>
                </div>

                <!-- Nghe lại bản ghi -->
                <audio id="audioPlayer" controls style="display:none; margin-top:15px; width:100%;"></audio>

                <!-- Hiển thị kết quả -->
                <div id="speechResult" class="result-box"></div>
                <div id="speechStatus" class="status-text"></div>
            </div>
        </div>

        <style>
            /* Khung chính */
            .listening-card {
                max-width: 500px;
                margin: 30px auto;
                padding: 25px;
                background: #ffffff;
                border-radius: 16px;
                box-shadow: 0 4px 15px rgba(0,0,0,0.1);
                text-align: center;
                font-family: "Segoe UI", sans-serif;
            }

            .title {
                font-size: 24px;
                color: #333;
                margin-bottom: 15px;
            }

            /* Khu vực hiển thị từ */
            .word-section {
                margin-top: 15px;
            }

            .word-box {
                font-size: 28px;
                font-weight: bold;
                background: #f0f4ff;
                color: #1d4ed8;
                padding: 12px 20px;
                border-radius: 12px;
                display: inline-block;
                margin: 10px 0;
                transition: transform 0.2s ease;
            }

                .word-box:hover {
                    transform: scale(1.1);
                }

            /* Nút hành động */
            .action-btn {
                margin: 6px;
                padding: 10px 20px;
                border: none;
                border-radius: 8px;
                font-size: 15px;
                cursor: pointer;
                background-color: #2563eb;
                color: white;
                transition: background 0.3s, transform 0.2s;
            }

                .action-btn:hover {
                    background-color: #1e40af;
                    transform: translateY(-2px);
                }

                .action-btn:disabled {
                    background-color: #9ca3af;
                    cursor: not-allowed;
                }

            .start {
                background-color: #10b981;
            }

                .start:hover {
                    background-color: #059669;
                }

            .stop {
                background-color: #ef4444;
            }

                .stop:hover {
                    background-color: #dc2626;
                }

            /* Kết quả */
            .result-box {
                margin-top: 15px;
                font-size: 16px;
                font-weight: 500;
                color: #111827;
                background: #f9fafb;
                border-radius: 10px;
                padding: 10px;
                display: block;
            }

            .status-text {
                margin-top: 8px;
                color: gray;
                font-size: 14px;
            }
        </style>



        <!-- 🔵 TAB 3: VIẾT -->
        <div id="writing" class="tab">
            @* <div class="card">
                <h2>Bài viết</h2>
                <textarea id="writingText" rows="5" style="width:100%" placeholder="Nhập đoạn văn cần kiểm tra..."></textarea>
                <button class="action" onclick="checkGrammar()">✅ Kiểm tra lỗi ngữ pháp</button>
            </div> *@

            <!-- ---------- PHẦN OCR / UPLOAD ẢNH ---------- -->
            <div class="card" style="margin-top:16px;">
                <h2>Nhận diện chữ viết tay (OCR)</h2>

                <!-- Nếu bạn dùng ASP.NET MVC với antiforgery, giữ dòng @Html.AntiForgeryToken() -->
                @* Nếu không dùng Razor, xóa dòng dưới *@
                @Html.AntiForgeryToken()

                <div style="display:flex;gap:12px;align-items:center;">
                    <input type="file" id="ocrFile" accept="image/*" />
                    <button id="btnOcr" class="action">🔍 Nhận diện</button>
                    <span id="ocrStatus" style="margin-left:8px;color:#666"></span>
                </div>

                <div id="previewContainer" style="margin-top:10px;">
                    <img id="previewImage" src="" alt="preview" style="max-width:100%; display:none; border:1px solid #ddd; padding:6px; border-radius:4px;" />
                </div>

                <h3 style="margin-top:12px">Kết quả</h3>
                <pre id="ocrResult" style="white-space:pre-wrap; background:#fafafa; padding:12px; border-radius:6px; min-height:60px;"></pre>
            </div>
        </div>

        @* <!-- 🟣 TAB 4: ĐỌC HIỂU -->
        <div id="reading" class="tab">
            <div class="card">
                <h2>Bài đọc</h2>
                <textarea id="readingText" rows="5" style="width:100%" placeholder="Nhập đoạn văn để sinh câu hỏi..."></textarea>
                <button class="action" onclick="generateQuestions()">❓ Tạo câu hỏi trắc nghiệm</button>
            </div>
        </div> *@

        <!-- 🟠 TAB 5: THI THỬ -->
        <div id="exam" class="tab">
            <div class="card">
                <h2>Bài thi</h2>

                <div id="quizContainer">
                    <div id="quizHeader" style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;">
                        <div><strong>Câu <span id="questionNumber">0</span> / <span id="totalQuestions">10</span></strong></div>
                        <div id="quizTimer" style="color:#666; font-size:0.9em"></div>
                    </div>

                    <p id="examQuestion" style="font-weight:600; min-height:48px;">Nhấn "Bắt đầu" để bắt đầu bài thi.</p>

                    <div id="answerButtons" style="display:flex;flex-direction:column;gap:8px; margin-top:8px;">
                        <button class="action answer-btn" data-choice="A" onclick="selectAnswer('A')">A</button>
                        <button class="action answer-btn" data-choice="B" onclick="selectAnswer('B')">B</button>
                        <button class="action answer-btn" data-choice="C" onclick="selectAnswer('C')">C</button>
                        <button class="action answer-btn" data-choice="D" onclick="selectAnswer('D')">D</button>
                    </div>

                    <div style="margin-top:12px; display:flex; gap:8px; align-items:center;">
                        <button id="startQuizBtn" class="action" onclick="startQuiz()">Bắt đầu</button>
                        <button id="nextBtn" class="action" onclick="nextQuestion()" style="display:none">Tiếp</button>
                        <div id="progressInfo" style="margin-left:12px;color:#666"></div>
                    </div>

                    <div id="quizResult" style="display:none; margin-top:14px;">
                        <h3>Kết quả</h3>
                        <p id="resultText"></p>
                        <button class="action" onclick="startQuiz()">Làm lại</button>
                    </div>
                </div>

            </div>
        </div>

        <!-- 🧠 TAB 6: CHATBOT -->
        <div id="chatbot" class="tab">
            <div class="card">
                <h2>Chatbot hội thoại</h2>
                <div id="chatbox" class="chatbox">
                    <p><b>Bot:</b> Hello! How are you?</p>
                </div>
                <div class="chat-input-row">
                    <input type="text" id="chatInput" placeholder="Nhập tin nhắn...">
                    <button class="action" onclick="sendMessage()">Gửi</button>
                </div>
            </div>
        </div>

        <!-- 📊 TAB 7: TIẾN ĐỘ -->
        <div id="progress" class="tab">
            <div class="card">
                <h2>Tiến độ học tập</h2>
                <button class="action" onclick="loadProgress()">🔄 Tải tiến độ</button>

                <div class="progress-row" style="margin-top:16px;">
                    <div>
                        <span>Học từ vựng</span>
                        <progress value="70" max="100"></progress>
                        <span>70%</span>
                    </div>
                    <div>
                        <span>Luyện nghe</span>
                        <progress value="50" max="100"></progress>
                        <span>50%</span>
                    </div>
                    <div>
                        <span>Luyện viết</span>
                        <progress value="30" max="100"></progress>
                        <span>30%</span>
                    </div>
                </div>
            </div>
        </div>
        
    </div>
</section>
@* 
Scripts {
    <script src="~/js/main.js"></script>
} *@


